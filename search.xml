<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>用于mingw-w64的opencv4编译指南及资源</title>
      <link href="posts/843d387b/"/>
      <url>posts/843d387b/</url>
      
        <content type="html"><![CDATA[<p>&emsp;&emsp;当我开始学习opencv的时候，发现官方只提供了用于vc、android和ios的库文件，而我所用的c++开发环境是VS Code编辑器与mingw-w64编译器，缺少库文件使我很为难，所以最终决定通过源代码自行编译。经过将近三个小时，我成功了。事后总结，我发现编译源代码其实并不难，难在自己初次尝试时保持足够的耐心去解决一些奇奇怪怪的bug。第一次总是很辛苦，所以我写作这篇教程，希望能帮你少走弯路。   </p><a id="more"></a><h2 id="编译准备"><a href="#编译准备" class="headerlink" title="编译准备"></a>编译准备</h2><p>&emsp;&emsp;本次编译的环境是windows10，需要下载一些辅助资源：首先是opencv源码，此次使用的是目前最新版本4.4.0；然后是mingw-w64编译器；其次需要使用cmake的GUI程序来帮助我们生成编译所需的配置文件。这些资源我都会尽量上传到蓝奏云，可以统一从我在文末给出的<a href="#4-资源链接">资源链接</a>中找到，但如果想要其他版本可以分别去下文中给出的对应地址下载。  </p><h3 id="opencv4-4-0源码"><a href="#opencv4-4-0源码" class="headerlink" title="opencv4.4.0源码"></a>opencv4.4.0源码</h3><p>&emsp;&emsp;源码可以在opencv的<a href="https://github.com/opencv/opencv" title="opencv的github仓库">github仓库</a>下载，嫌速度慢可以配合我<a href="https://zhizunjiege.github.io/2020/06/20/Kirikiroid2%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" title="Kirikiroid2使用指南">上篇文章</a>提到的github下载加速网站。理论上来说最近的几个版本都可以编译，不过还是建议选最新的版本。下载后将源码解压，并在源代码文件夹外新建一个build文件夹用来存放编译过程中产生的中间文件。</p><h3 id="mingw-w64编译器"><a href="#mingw-w64编译器" class="headerlink" title="mingw-w64编译器"></a>mingw-w64编译器</h3><p>&emsp;&emsp;<a href="http://mingw-w64.org/doku.php" title="mingw-w64官网">mingw-w64</a>与<a href="http://mingw.org/" title="mingw官网">mingw</a>是不一样的，详情可以查看各自的官网。我们需要下载<strong>posix版本</strong>的mingw-w64，因为opencv使用的是符合posix规范的多线程api。在SOURCEFORGE的<a href="https://sourceforge.net/projects/mingw-w64/files/mingw-w64/mingw-w64-release/" title="mingw-w64下载链接">opencv下载页面</a>，找到如下区域：  </p><p><img src="https://img-blog.csdnimg.cn/20191231184323866.jpeg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppcWlyZW5fZGFzaGVuZw==,size_16,color_FFFFFF,t_70" alt="第一步" title="第一步" loading="lazy">  </p><p><img src="https://img-blog.csdnimg.cn/20191231184353673.jpeg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppcWlyZW5fZGFzaGVuZw==,size_16,color_FFFFFF,t_70" alt="第二步" title="第二步" loading="lazy">  </p><p>&emsp;&emsp;下载x86_64-posix-seh后解压即可，并将该解压后目录下的bin文件夹添加到系统环境变量。  </p><h3 id="cmake程序"><a href="#cmake程序" class="headerlink" title="cmake程序"></a>cmake程序</h3><p>&emsp;&emsp;cmake可以去<a href="https://cmake.org/download/" title="cmake官网下载链接">官网下载</a>，找到符合自己设备配置的安装程序下载后安装即可，安装时最好勾选“添加桌面图标”。</p><hr><h2 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h2><h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><p>&emsp;&emsp;打开cmake GUI程序，分别点击“Browse Source…”和“Browse Build…”选择好之前解压的源代码文件夹和新建的build文件夹，如下图所示：  </p><p><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E9%80%89%E6%8B%A9%E6%BA%90%E4%BB%A3%E7%A0%81.png" alt="选择源代码" title="选择源代码" loading="lazy"></p><p>&emsp;&emsp;点击“Configure”，在“Specify the generator for this project”中选择“MinGW Makefiles”，下方的单选框选择“Specify native compilers”,如下图所示：  </p><p><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E9%80%89%E6%8B%A9makefile.png" alt="选择makefile配置" title="选择makefile配置" loading="lazy"></p><p>&emsp;&emsp;点击“Next”，选择c和c++编译器，分别是你安装mingw-w64的目录下的bin文件夹中的gcc.exe和g++.exe，如下图所示：  </p><p><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E9%80%89%E6%8B%A9%E7%BC%96%E8%AF%91%E5%99%A8.png" alt="选择编译器" title="选择编译器" loading="lazy"></p><p>&emsp;&emsp;点击“Finish”，等待一段时间（请保持耐心），直到配置完成，如下图所示：  </p><p><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E9%85%8D%E7%BD%AE%E5%AE%8C%E6%88%90.png" alt="配置完成" title="配置完成" loading="lazy">  </p><h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a><strong>注意</strong></h4><p>&emsp;&emsp;如果配置失败，并且具有“opencv_ffmpeg.dll下载失败”之类的报错信息，请将<a href="#4-资源链接">资源链接</a>中下载的ffmpeg文件夹中内容复制到源代码目录下.cache/ffmpeg文件夹中，如下图所示：  </p><p><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/ffmpeg.png" alt="ffmpeg" title="ffmpeg" loading="lazy">  </p><p>&emsp;&emsp;配置成功后，可以看到cmake界面上出现很多配置项。这些配置可以按需修改，前提是你得理解这些配置代表什么含义。我只能模糊地理解其中一部分，在此就不解释了。下面是我所用的配置，追求编译速度尽量快而且功能够用即可。想修改的话请自行查阅其他资料，一个原则是：对不确定的配置项不做改动，沿用默认值即可。  </p><p>&emsp;&emsp;需要取消勾选的项是： </p><ol><li>BUILD_JAVA</li><li>BUILD_PERF_TESTS</li><li>BUILD_TESTS</li></ol><p>&emsp;&emsp;需要勾选的项是：</p><ol><li>BUILD_opencv_world</li><li>WITH_OPENGL</li></ol><p>&emsp;&emsp;配置完后再次点击“Configure”，直到页面由红变白，然后点击“Generate”。  </p><p>&emsp;&emsp;来到build文件夹下，在此处打开cmd或powershell窗口，执行命令  </p><pre class="language-shell" data-language="shell"><code class="language-shell">mingw32-make -j 8</code></pre><p>&emsp;&emsp;其中 <code>-j</code> 是控制编译所用线程数的参数，这可以根据电脑性能来决定，电脑不好的话可以改成4线程。等待编译完成，这需要花费一定时间。</p><h4 id="注意-1"><a href="#注意-1" class="headerlink" title="注意"></a><strong>注意</strong></h4><p>&emsp;&emsp;如果编译失败，且报错信息如下图所示，则手动执行命令  </p><pre class="language-shell" data-language="shell"><code class="language-shell">cd modules&#x2F;worldwindres vs_version.rc -O coff CMakeFiles\opencv_world.dir\vs_version.rc.objmingw32-make -j 8</code></pre><p>&emsp;&emsp;结果见下图：  </p><p>  <img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E7%BC%96%E8%AF%91%E6%8A%A5%E9%94%99.png" alt="编译报错" title="编译报错" loading="lazy">   </p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>&emsp;&emsp;编译完成后，在控制台窗口继续执行  </p><pre class="language-shell" data-language="shell"><code class="language-shell">mingw32-make install</code></pre><p>&emsp;&emsp;等待安装完成。在这次安装过程中，我发现少安装了几个文件，需要手动复制过去。这些文件如下：</p><ol><li>opencv4.4.0/include/opencv2/opencv2.hpp</li><li>build/opencv2/cvconfig.h</li><li>build/opencv2/opencv_modules.hpp</li></ol><p>&emsp;&emsp;将这些文件全部复制到 <code>build/install/include/opencv2</code> 文件夹下即可，install文件夹下就是我们需要的所有文件。值得一提的是，我以前编译opencv4.2.0源码时没有出现过这个问题，我只能猜想是新版本的安装脚本发生了某些变动，也或者是我的配置有误，你要有空，可以试试不改配置直接生成makefile并编译。我会将opencv4.2.0编译后的库文件也上传到蓝奏云中，两个版本随你选择。</p><hr><h2 id="测试程序"><a href="#测试程序" class="headerlink" title="测试程序"></a>测试程序</h2><p>&emsp;&emsp;为了调试方便，首先将 install 文件夹下的 x64/mingw/bin 文件夹添加到系统环境变量，例如我电脑上的路径为：   </p><pre class="language-none"><code class="language-none">H:\Code\c++\opencv\build\install\x64\mingw\bin</code></pre><p>&emsp;&emsp;打开VS Code，配置好.vscode文件夹下的三个文件：  </p><ol><li>c_cpp_properties.json  </li><li>launch.json  </li><li>tasks.json  </li></ol><p>&emsp;&emsp;写一段示例程序并找一张图片用来测试，执行 Ctrl+Shift+B 编译程序，再执行 Ctrl+Shift+T 运行程序，如果没有错误，你将看到图片显示在窗口中。</p><p><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E6%B5%8B%E8%AF%95%E6%88%90%E5%8A%9F.png" alt="测试成功" title="测试成功" loading="lazy"></p><hr><h2 id="资源链接"><a href="#资源链接" class="headerlink" title="资源链接"></a>资源链接</h2><p>&emsp;&emsp;本次资源包含以下文件：  </p><ol><li>opencv4.4.0 源代码</li><li>mingw-w64 编译器</li><li>cmake 程序（蓝奏云不支持msi格式，所以进行了压缩，需要解压）</li><li>第三方库 ffmpeg 文件（cmake配置报错时使用）</li><li>opencv4.4.0 与 opencv4.2.0 编译完成后的库文件（懒人福音^_^）</li><li>vscode用于c++的3个配置文件（需按自己实际情况进行改动）</li><li>测试程序源文件</li><li>一个自主编写的makefile文件，用于opencv学习过程中小项目的编译~</li></ol><p>&emsp;&emsp;<a href="https://www.lanzoui.com/b01ho83wb" title="密码：3pi9">资源链接</a>在这里，密码是3pi9。</p><hr><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><blockquote><ol><li><a href="https://www.cnblogs.com/uestc-mm/p/12758110.html">Windows10下Opencv4+CMake+MinGW64+VSC安装教程</a></li><li><a href="https://docs.opencv.org/4.4.0/d3/d52/tutorial_windows_install.html">OpenCV Tutorials : Introduction to OpenCV : Installation in Windows</a></li><li><a href="https://blog.csdn.net/sz76211822/article/details/82428295">CMake编译opencv各选项的含义</a></li><li><a href="https://blog.csdn.net/tfb760/article/details/104030841">提升OpenCV编译速度的方法</a></li></ol></blockquote><hr><h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>&emsp;&emsp;此次编译最大的问题是安装4.4.0库文件时缺少了几个文件，我依稀记得编译4.2.0时好像没出这种幺蛾子，于是用相同的配置把4.2.0也编译了一遍，结果证明不是我的操作与配置问题ヽ(✿ﾟ▽ﾟ)ノ<br>&emsp;&emsp;写作这篇文章时，我力求清晰与详尽，所以可能显得有点啰嗦，还请见谅！</p><hr>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>推荐两款chrome插件</title>
      <link href="posts/a82482e7/"/>
      <url>posts/a82482e7/</url>
      
        <content type="html"><![CDATA[<p>&emsp;&emsp;这次给大家推荐两款实用的chrome插件，废话少说，直接上干货，插件ID和安装方法见附录。</p><a id="more"></a><h2 id="Markdown-Here"><a href="#Markdown-Here" class="headerlink" title="Markdown Here"></a><em>Markdown Here</em></h2><p>&emsp;&emsp;Markdown Here可以使你在富文本编辑器中使用Markdown格式来编写文本，之后只需非常简单的操作：</p><ol><li>全选文本；</li><li>点击Markdown Here的插件图标。  </li></ol><p>&emsp;&emsp;具体步骤如下图所示：<br><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/chrome-extensions/markdown-here.gif" alt="Markdown Here操作步骤" loading="lazy"><br>&emsp;&emsp;Markdown Here会将所有Markdown文本转换为富文本编辑器对应的格式，但可能有些Markdown格式不受编辑器支持，需要自己细心检查，比如B站专栏不支持外链图片。</p><hr><h2 id="GitZip-for-Github"><a href="#GitZip-for-Github" class="headerlink" title="GitZip for Github"></a><em>GitZip for Github</em></h2><p>&emsp;&emsp;GitZip for Github（以下简称GitZip）可以让你在Github上直接下载单个或多个文件（夹），而不必下载整个repo，当我们只需要repo中的一部分文件时，这显得非常有用。操作也非常简单：  </p><ol><li>双击需要下载的文件（夹），可以多选；</li><li>点击右下角的下载图标。 </li></ol><p>&emsp;&emsp;动图演示如下：<br><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/chrome-extensions/gitzip.gif" alt="GitZip操作步骤" loading="lazy">  </p><hr><h1 id="附录：如何安装chrome插件"><a href="#附录：如何安装chrome插件" class="headerlink" title="附录：如何安装chrome插件"></a>附录：如何安装chrome插件</h1><p>&emsp;&emsp;有能力访问Google的朋友可以直接上<a href="https://chrome.google.com/webstore/category/extensions?hl=zh-CN" title="Chrome网上应用店">Chrome网上应用店</a>搜索插件并下载安装，没有能力的朋友可以上<a href="https://crxdown.com/" title="chrome插件下载代理">crxdown.com</a>输入插件的地址或ID进行下载，下载得到后缀为<strong>crx</strong>的文件，将其解压，并来到Chrome的<strong>扩展程序管理器</strong>，右上角点击开启<strong>开发者模式</strong>，然后点击左上角<strong>加载已解压的扩展程序</strong>，找到刚才解压得到的文件夹，即可完成安装。<br>&emsp;&emsp;安装完成后最好刷新页面，使插件生效。<br>&emsp;&emsp;本次推荐的插件ID分别为：  </p><ol><li>Markdown Here：<pre class="language-none"><code class="language-none">mdaelejdhngebimjjipllddfaahcgdck</code></pre></li><li>GitZip：<pre class="language-none"><code class="language-none">eifidbmjijlblfejfeicoidahoidecoe</code></pre></li></ol><hr>]]></content>
      
      
      <categories>
          
          <category> 资源 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kirikiroid2使用指南</title>
      <link href="posts/43f77427/"/>
      <url>posts/43f77427/</url>
      
        <content type="html"><![CDATA[<p>&emsp;&emsp;Kirikiroid2是一款模拟器，能在移动端直接运行基于Kirikiri2和KirikiriZ引擎开发的游戏。<br>&emsp;&emsp;我曾尝试着寻找这个软件的使用教程，希望能在手机上游玩「枯れない世界と終わる花」这款游戏，但在很多帖子里只得到相对模糊的介绍，而楼主们仿佛不屑于介绍地更为详细。直到我发现这篇<a href="https://www.marron.work/2017/03/95/" title="(完全版？)Kirikiroid2とXP3Playerの使い方">日文教程</a>，作者是赤西真論，原文有上万字，配图几十张，可以说是我见过最为详细的教程。本想对其进行翻译，但无奈原文实在太长，只好作一定删减，并以自己的角度来写作这一篇指南，希望对你有所帮助。  </p><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a><strong>注意</strong></h3><p>&emsp;&emsp;阅读指南前请先确认你想玩的游戏确实是使用Kirikiri2或KirikiriZ开发的，特点是游戏文件夹内有以xp3为后缀的文件。由于缺乏设备，本文所有步骤只在安卓系统上测试通过，IOS系统的步骤类似，请对照着进行，或者直接访问上面提到的赤西真論的教程。（你懂日文的话）  </p><a id="more"></a><h2 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h2><p>&emsp;&emsp;可以去Kirikiroid2的<a href="https://github.com/zeas2/Kirikiroid2/releases" title="下载">github仓库</a>页面下载最新版的安装包，但网速一般很慢，结合这个<a href="https://shrill-pond-3e81.hunsh.workers.dev/" title="文件下载加速">github下载加速网站</a>速度稍微快点，使用方法一看就懂。或者从我分享的<a href="https://wws.lanzous.com/b01hgaaaf" title="密码：87pb">蓝奏云链接</a>来下载，密码：87pb。当然，你也可以去Google Play付费购买，安卓系统的叫Kirikiroid2，IOS的叫Xp3player。<br>&emsp;&emsp;推荐蓝奏云下载，速度很快。</p><hr><h2 id="准备补丁"><a href="#准备补丁" class="headerlink" title="准备补丁"></a>准备补丁</h2><p>&emsp;&emsp;由于游戏文件进行了一定加密，很多游戏如果没有补丁就无法运行，当然也有些游戏无需补丁就可以启动，但我还是建议去以下网站搜索一下有没有对应的补丁  </p><blockquote><ol><li><a href="https://zeas2.github.io/Kirikiroid2_patch/patch/" title="Kirikiroid2项目作者个人博客">Patch List(GitHub.io)</a>  </li><li><a href="http://avgfun.net/viewforum.php?f=4&sid=c0406ca29618c05c53c262823d3a115e" title="未验证">AVGFun</a>  </li></ol></blockquote><p>&emsp;&emsp;以第一个网站为例，搜索「枯れない世界と終わる花」<br><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/kirikiroid2/1.png" alt="图片1" loading="lazy"><br>&emsp;&emsp;点击左边的GET即可下载补丁。<br>&emsp;&emsp;如果找到了对应的补丁，下载下来并解压。没找到的话也可以尝试接下来的步骤，但有一定概率失败。补丁一般包含一个xp3filter.tjs文件，此外还<strong>可能</strong>有一个krz_xp3conv.exe可执行文件。</p><hr><h2 id="下载游戏"><a href="#下载游戏" class="headerlink" title="下载游戏"></a>下载游戏</h2><p>&emsp;&emsp;找到你想要玩的游戏并下载，将之前下载好的补丁里的文件全部放到游戏文件夹下，以「枯れない世界と終わる花」为例，其文件夹结构如下图所示<br><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/kirikiroid2/2.png" alt="图片2" loading="lazy"><br>&emsp;&emsp;不同的游戏可能有不同的结构，但一般有xp3文件和plugin文件夹里的dll文件。如果之前的补丁里有krz_xp3conv.exe，双击运行它，等到控制台出现“按任意键继续……”的文字时，表示文件解密成功；没有该exe文件则直接进入下一步。  </p><hr><h2 id="运行游戏"><a href="#运行游戏" class="headerlink" title="运行游戏"></a>运行游戏</h2><p>&emsp;&emsp;将整个游戏文件夹复制到手机内存中，打开Kirikiroid2，利用软件内的文件管理器找到游戏文件夹，点击文件夹下的data.xp3。初次运行时会出现一个操作介绍页面，点击右上角的“X”关闭即可，等待一会儿，脚本执行完毕，游戏就可以成功运行。<br><img src="https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/kirikiroid2/3.png" alt="图片3" loading="lazy">  </p><hr><h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><blockquote><p>&emsp;&emsp;赤西真論曾在他的教程最后说到，他在尝试运行「枯れない世界と終わる花」这款游戏时遭到了挫败，解密文件的时候出错，所以他选择了放弃，而我特意选择了这款游戏来做我的例子2333。我曾给他留言问询是否可以将他的教程翻译为中文，但最终也未能收到回复，现在都一年多了。</p></blockquote><hr>]]></content>
      
      
      <categories>
          
          <category> 资源 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello world，这是新的开始</title>
      <link href="posts/d9d8a069/"/>
      <url>posts/d9d8a069/</url>
      
        <content type="html"><![CDATA[<p>&emsp;&emsp;经过两天断断续续的折腾，我的个人博客站点终于搭建完毕了！！！</p><a id="more"></a><p>&emsp;&emsp;这次采用的资源与技术是Github Pages和Hexo，搭建过程还算简单，其实这个站点的本质就是一个repo（仓库），存储了一些html、css、js和图片等静态内容，当你访问这个网址的时候，github会将对应的内容推送给你，所以其实是抱github的大腿啦<del>~</del>  </p><p>&emsp;&emsp;而Hexo呢，作用是通过一定规则将编写的资源生成上述提到的静态内容（什么规则？我也不知道。。。）其中比较重要的就是这个theme（主题），它决定了页面具体的呈现方式（Hexo只决定了整体框架，具体内容需要theme来填充）。这个主题叫<a href="https://docs.hojun.cn/sakura/docs/#/" title="Sakura的官网">Sakura</a>，我是从github上找到的，看起来还比较漂亮吧，由于没有自己的服务器或cdn，我删减了很多部分，折腾两天，我也魔改了一下2333。作者是<a href="https://github.com/honjun" title="hojun的github">hojun</a>，感谢这个b……ilibili的Up🐖！但是不得不说ta这个文档写的……嗯……我这样的菜鸟看起来还是有些迷糊。 </p><p>&emsp;&emsp;详细的内容就不展开说了，有兴趣自己搭建这样一个静态博客的话，可以来联系我~</p><blockquote><p>PS：欢迎加微信来探♂讨知识</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 记录 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
