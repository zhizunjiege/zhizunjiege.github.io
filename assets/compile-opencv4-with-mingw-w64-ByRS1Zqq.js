import{_ as u}from"./ValaxyMain.vue_vue_type_style_index_0_lang-B9z_4Hnv.js";import{c as m,w as e,f as k,e as f,p,o as h,g as l,v,h as n,r as s}from"./app-Bkzu69aX.js";import"./YunComment.vue_vue_type_style_index_0_lang-x7su-lS2.js";import"./index-C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-DF9C8biv.js";import"./post-CFViN5ca.js";const j={__name:"compile-opencv4-with-mingw-w64",setup(b,{expose:g}){const r=JSON.parse('{"title":"用于mingw-w64的opencv4编译指南及资源","description":"","frontmatter":{"title":"用于mingw-w64的opencv4编译指南及资源","date":"2020/9/24 20:00:00","updated":"2021/3/27 12:33:00","categories":"学习笔记","tags":["软件","编译","教程","opencv","mingw-w64"]},"headers":[{"level":2,"title":"编译准备","slug":"编译准备","link":"#编译准备","children":[{"level":3,"title":"opencv4.4.0源码","slug":"opencv4-4-0源码","link":"#opencv4-4-0源码","children":[]},{"level":3,"title":"mingw-w64编译器","slug":"mingw-w64编译器","link":"#mingw-w64编译器","children":[]},{"level":3,"title":"cmake程序","slug":"cmake程序","link":"#cmake程序","children":[]}]},{"level":2,"title":"编译安装","slug":"编译安装","link":"#编译安装","children":[{"level":3,"title":"编译","slug":"编译","link":"#编译","children":[]},{"level":3,"title":"安装","slug":"安装","link":"#安装","children":[]}]},{"level":2,"title":"测试程序","slug":"测试程序","link":"#测试程序","children":[]},{"level":2,"title":"资源链接","slug":"资源链接","link":"#资源链接","children":[]},{"level":2,"title":"参考资料","slug":"参考资料","link":"#参考资料","children":[]},{"level":2,"title":"后记","slug":"后记","link":"#后记","children":[]}],"relativePath":"pages/posts/compile-opencv4-with-mingw-w64.md","path":"/home/runner/work/zhizunjiege.github.io/zhizunjiege.github.io/pages/posts/compile-opencv4-with-mingw-w64.md","lastUpdated":1730304709000}'),o=f(),a=r.frontmatter||{};return o.meta.frontmatter=Object.assign(o.meta.frontmatter||{},r.frontmatter||{}),p("pageData",r),p("valaxy:frontmatter",a),globalThis.$frontmatter=a,g({frontmatter:{title:"用于mingw-w64的opencv4编译指南及资源",date:"2020/9/24 20:00:00",updated:"2021/3/27 12:33:00",categories:"学习笔记",tags:["软件","编译","教程","opencv","mingw-w64"]}}),(t,i)=>{const d=u;return h(),m(d,{frontmatter:k(a)},{"main-content-md":e(()=>[i[0]||(i[0]=l("p",null,"  当我开始学习opencv的时候，发现官方只提供了用于vc、android和ios的库文件，而我所用的c++开发环境是VS Code编辑器与mingw-w64编译器，缺少库文件使我很为难，所以最终决定通过源代码自行编译。经过将近三个小时，我成功了。事后总结，我发现编译源代码其实并不难，难在自己初次尝试时保持足够的耐心去解决一些奇奇怪怪的bug。第一次总是很辛苦，所以我写作这篇教程，希望能帮你少走弯路。",-1)),v(" more "),i[1]||(i[1]=l("h2",{id:"编译准备",tabindex:"-1"},[n("编译准备 "),l("a",{class:"header-anchor",href:"#编译准备","aria-label":'Permalink to "编译准备"'},"​")],-1)),i[2]||(i[2]=l("p",null,[n("  本次编译的环境是windows10，需要下载一些辅助资源：首先是opencv源码，此次使用的是目前最新版本4.4.0；然后是mingw-w64编译器；其次需要使用cmake的GUI程序来帮助我们生成编译所需的配置文件。这些资源我都会尽量上传到蓝奏云，可以统一从我在文末给出的"),l("a",{href:"#4-%E8%B5%84%E6%BA%90%E9%93%BE%E6%8E%A5"},"资源链接"),n("中找到，但如果想要其他版本可以分别去下文中给出的对应地址下载。")],-1)),i[3]||(i[3]=l("h3",{id:"opencv4-4-0源码",tabindex:"-1"},[n("opencv4.4.0源码 "),l("a",{class:"header-anchor",href:"#opencv4-4-0源码","aria-label":'Permalink to "opencv4.4.0源码"'},"​")],-1)),i[4]||(i[4]=l("p",null,[n("  源码可以在opencv的"),l("a",{href:"https://github.com/opencv/opencv",title:"opencv的github仓库",target:"_blank",rel:"noreferrer"},"github仓库"),n("下载，嫌速度慢可以配合我"),l("a",{href:"https://zhizunjiege.github.io/2020/06/20/Kirikiroid2%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/",title:"Kirikiroid2使用指南",target:"_blank",rel:"noreferrer"},"上篇文章"),n("提到的github下载加速网站。理论上来说最近的几个版本都可以编译，不过还是建议选最新的版本。下载后将源码解压，并在源代码文件夹外新建一个build文件夹用来存放编译过程中产生的中间文件。")],-1)),i[5]||(i[5]=l("h3",{id:"mingw-w64编译器",tabindex:"-1"},[n("mingw-w64编译器 "),l("a",{class:"header-anchor",href:"#mingw-w64编译器","aria-label":'Permalink to "mingw-w64编译器"'},"​")],-1)),i[6]||(i[6]=l("p",null,[n("  "),l("a",{href:"http://mingw-w64.org/doku.php",title:"mingw-w64官网",target:"_blank",rel:"noreferrer"},"mingw-w64"),n("与"),l("a",{href:"http://mingw.org/",title:"mingw官网",target:"_blank",rel:"noreferrer"},"mingw"),n("是不一样的，详情可以查看各自的官网。我们需要下载"),l("strong",null,"posix版本"),n("的mingw-w64，因为opencv使用的是符合posix规范的多线程api。在SOURCEFORGE的"),l("a",{href:"https://sourceforge.net/projects/mingw-w64/files/mingw-w64/mingw-w64-release/",title:"mingw-w64下载链接",target:"_blank",rel:"noreferrer"},"opencv下载页面"),n("，找到如下区域：")],-1)),i[7]||(i[7]=l("figure",null,[l("img",{src:"https://img-blog.csdnimg.cn/20191231184323866.jpeg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppcWlyZW5fZGFzaGVuZw==,size_16,color_FFFFFF,t_70",alt:"第一步",loading:"lazy",decoding:"async"}),l("figcaption",null,"第一步")],-1)),i[8]||(i[8]=l("figure",null,[l("img",{src:"https://img-blog.csdnimg.cn/20191231184353673.jpeg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppcWlyZW5fZGFzaGVuZw==,size_16,color_FFFFFF,t_70",alt:"第二步",loading:"lazy",decoding:"async"}),l("figcaption",null,"第二步")],-1)),i[9]||(i[9]=l("p",null,"  下载x86_64-posix-seh后解压即可，并将该解压后目录下的bin文件夹添加到系统环境变量。",-1)),i[10]||(i[10]=l("h3",{id:"cmake程序",tabindex:"-1"},[n("cmake程序 "),l("a",{class:"header-anchor",href:"#cmake程序","aria-label":'Permalink to "cmake程序"'},"​")],-1)),i[11]||(i[11]=l("p",null,[n("  cmake可以去"),l("a",{href:"https://cmake.org/download/",title:"cmake官网下载链接",target:"_blank",rel:"noreferrer"},"官网下载"),n("，找到符合自己设备配置的安装程序下载后安装即可，安装时最好勾选“添加桌面图标”。")],-1)),i[12]||(i[12]=l("hr",null,null,-1)),i[13]||(i[13]=l("h2",{id:"编译安装",tabindex:"-1"},[n("编译安装 "),l("a",{class:"header-anchor",href:"#编译安装","aria-label":'Permalink to "编译安装"'},"​")],-1)),i[14]||(i[14]=l("h3",{id:"编译",tabindex:"-1"},[n("编译 "),l("a",{class:"header-anchor",href:"#编译","aria-label":'Permalink to "编译"'},"​")],-1)),i[15]||(i[15]=l("p",null,"  打开cmake GUI程序，分别点击“Browse Source…”和“Browse Build…”选择好之前解压的源代码文件夹和新建的build文件夹，如下图所示：",-1)),i[16]||(i[16]=l("figure",null,[l("img",{src:"https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E9%80%89%E6%8B%A9%E6%BA%90%E4%BB%A3%E7%A0%81.png",alt:"选择源代码",loading:"lazy",decoding:"async"}),l("figcaption",null,"选择源代码")],-1)),i[17]||(i[17]=l("p",null,"  点击“Configure”，在“Specify the generator for this project”中选择“MinGW Makefiles”，下方的单选框选择“Specify native compilers”,如下图所示：",-1)),i[18]||(i[18]=l("figure",null,[l("img",{src:"https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E9%80%89%E6%8B%A9makefile.png",alt:"选择makefile配置",loading:"lazy",decoding:"async"}),l("figcaption",null,"选择makefile配置")],-1)),i[19]||(i[19]=l("p",null,"  点击“Next”，选择c和c++编译器，分别是你安装mingw-w64的目录下的bin文件夹中的gcc.exe和g++.exe，如下图所示：",-1)),i[20]||(i[20]=l("figure",null,[l("img",{src:"https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E9%80%89%E6%8B%A9%E7%BC%96%E8%AF%91%E5%99%A8.png",alt:"选择编译器",loading:"lazy",decoding:"async"}),l("figcaption",null,"选择编译器")],-1)),i[21]||(i[21]=l("p",null,"  点击“Finish”，等待一段时间（请保持耐心），直到配置完成，如下图所示：",-1)),i[22]||(i[22]=l("figure",null,[l("img",{src:"https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E9%85%8D%E7%BD%AE%E5%AE%8C%E6%88%90.png",alt:"配置完成",loading:"lazy",decoding:"async"}),l("figcaption",null,"配置完成")],-1)),i[23]||(i[23]=l("h4",{id:"注意",tabindex:"-1"},[l("strong",null,"注意"),n(),l("a",{class:"header-anchor",href:"#注意","aria-label":'Permalink to "**注意**"'},"​")],-1)),i[24]||(i[24]=l("p",null,[n("  如果配置失败，并且具有“opencv_ffmpeg.dll下载失败”之类的报错信息，请将"),l("a",{href:"#4-%E8%B5%84%E6%BA%90%E9%93%BE%E6%8E%A5"},"资源链接"),n("中下载的ffmpeg文件夹中内容复制到源代码目录下.cache/ffmpeg文件夹中，如下图所示：")],-1)),i[25]||(i[25]=l("figure",null,[l("img",{src:"https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/ffmpeg.png",alt:"ffmpeg",loading:"lazy",decoding:"async"}),l("figcaption",null,"ffmpeg")],-1)),i[26]||(i[26]=l("p",null,"  配置成功后，可以看到cmake界面上出现很多配置项。这些配置可以按需修改，前提是你得理解这些配置代表什么含义。我只能模糊地理解其中一部分，在此就不解释了。下面是我所用的配置，追求编译速度尽量快而且功能够用即可。想修改的话请自行查阅其他资料，一个原则是：对不确定的配置项不做改动，沿用默认值即可。",-1)),i[27]||(i[27]=l("p",null,"  需要取消勾选的项是：",-1)),i[28]||(i[28]=l("ol",null,[l("li",null,"BUILD_JAVA"),l("li",null,"BUILD_PERF_TESTS"),l("li",null,"BUILD_TESTS")],-1)),i[29]||(i[29]=l("p",null,"  需要勾选的项是：",-1)),i[30]||(i[30]=l("ol",null,[l("li",null,"BUILD_opencv_world"),l("li",null,"WITH_OPENGL")],-1)),i[31]||(i[31]=l("p",null,"  配置完后再次点击“Configure”，直到页面由红变白，然后点击“Generate”。",-1)),i[32]||(i[32]=l("p",null,"  来到build文件夹下，在此处打开cmd或powershell窗口，执行命令",-1)),i[33]||(i[33]=l("div",{class:"language-bash vp-adaptive-theme"},[l("button",{title:"Copy Code",class:"copy"}),l("span",{class:"lang"},"bash"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mingw32-make"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 8")])])]),l("button",{class:"collapse"})],-1)),i[34]||(i[34]=l("p",null,[n("  其中 "),l("code",null,"-j"),n(" 是控制编译所用线程数的参数，这可以根据电脑性能来决定，电脑不好的话可以改成4线程。等待编译完成，这需要花费一定时间。")],-1)),i[35]||(i[35]=l("h4",{id:"注意-1",tabindex:"-1"},[l("strong",null,"注意"),n(),l("a",{class:"header-anchor",href:"#注意-1","aria-label":'Permalink to "**注意**"'},"​")],-1)),i[36]||(i[36]=l("p",null,"  如果编译失败，且报错信息如下图所示，则手动执行命令",-1)),i[37]||(i[37]=l("div",{class:"language-bash vp-adaptive-theme"},[l("button",{title:"Copy Code",class:"copy"}),l("span",{class:"lang"},"bash"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," modules/world")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"windres"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," vs_version.rc"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -O"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," coff"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," CMakeFiles"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\o"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"pencv_world.dir"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\v"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"s_version.rc.obj")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mingw32-make"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 8")])])]),l("button",{class:"collapse"})],-1)),i[38]||(i[38]=l("p",null,"  结果见下图：",-1)),i[39]||(i[39]=l("figure",null,[l("img",{src:"https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E7%BC%96%E8%AF%91%E6%8A%A5%E9%94%99.png",alt:"编译报错",loading:"lazy",decoding:"async"}),l("figcaption",null,"编译报错")],-1)),i[40]||(i[40]=l("h3",{id:"安装",tabindex:"-1"},[n("安装 "),l("a",{class:"header-anchor",href:"#安装","aria-label":'Permalink to "安装"'},"​")],-1)),i[41]||(i[41]=l("p",null,"  编译完成后，在控制台窗口继续执行",-1)),i[42]||(i[42]=l("div",{class:"language-bash vp-adaptive-theme"},[l("button",{title:"Copy Code",class:"copy"}),l("span",{class:"lang"},"bash"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mingw32-make"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install")])])]),l("button",{class:"collapse"})],-1)),i[43]||(i[43]=l("p",null,"  等待安装完成。在这次安装过程中，我发现少安装了几个文件，需要手动复制过去。这些文件如下：",-1)),i[44]||(i[44]=l("ol",null,[l("li",null,"opencv4.4.0/include/opencv2/opencv2.hpp"),l("li",null,"build/opencv2/cvconfig.h"),l("li",null,"build/opencv2/opencv_modules.hpp")],-1)),i[45]||(i[45]=l("p",null,[n("  将这些文件全部复制到 "),l("code",null,"build/install/include/opencv2"),n(" 文件夹下即可，install文件夹下就是我们需要的所有文件。值得一提的是，我以前编译opencv4.2.0源码时没有出现过这个问题，我只能猜想是新版本的安装脚本发生了某些变动，也或者是我的配置有误，你要有空，可以试试不改配置直接生成makefile并编译。我会将opencv4.2.0编译后的库文件也上传到蓝奏云中，两个版本随你选择。")],-1)),i[46]||(i[46]=l("hr",null,null,-1)),i[47]||(i[47]=l("h2",{id:"测试程序",tabindex:"-1"},[n("测试程序 "),l("a",{class:"header-anchor",href:"#测试程序","aria-label":'Permalink to "测试程序"'},"​")],-1)),i[48]||(i[48]=l("p",null,"  为了调试方便，首先将 install 文件夹下的 x64/mingw/bin 文件夹添加到系统环境变量，例如我电脑上的路径为：",-1)),i[49]||(i[49]=l("div",{class:"language- vp-adaptive-theme"},[l("button",{title:"Copy Code",class:"copy"}),l("span",{class:"lang"}),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",null,"H:\\Code\\c++\\opencv\\build\\install\\x64\\mingw\\bin")])])]),l("button",{class:"collapse"})],-1)),i[50]||(i[50]=l("p",null,"  打开VS Code，配置好.vscode文件夹下的三个文件：",-1)),i[51]||(i[51]=l("ol",null,[l("li",null,"c_cpp_properties.json"),l("li",null,"launch.json"),l("li",null,"tasks.json")],-1)),i[52]||(i[52]=l("p",null,"  写一段示例程序并找一张图片用来测试，执行 Ctrl+Shift+B 编译程序，再执行 Ctrl+Shift+T 运行程序，如果没有错误，你将看到图片显示在窗口中。",-1)),i[53]||(i[53]=l("figure",null,[l("img",{src:"https://cdn.jsdelivr.net/gh/zhizunjiege/cdn/img/post/opencv4/%E6%B5%8B%E8%AF%95%E6%88%90%E5%8A%9F.png",alt:"测试成功",loading:"lazy",decoding:"async"}),l("figcaption",null,"测试成功")],-1)),i[54]||(i[54]=l("hr",null,null,-1)),i[55]||(i[55]=l("h2",{id:"资源链接",tabindex:"-1"},[n("资源链接 "),l("a",{class:"header-anchor",href:"#资源链接","aria-label":'Permalink to "资源链接"'},"​")],-1)),i[56]||(i[56]=l("p",null,"  本次资源包含以下文件：",-1)),i[57]||(i[57]=l("ol",null,[l("li",null,"opencv4.4.0 源代码"),l("li",null,"mingw-w64 编译器"),l("li",null,"cmake 程序（蓝奏云不支持msi格式，所以进行了压缩，需要解压）"),l("li",null,"第三方库 ffmpeg 文件（cmake配置报错时使用）"),l("li",null,"opencv4.4.0 与 opencv4.2.0 编译完成后的库文件（懒人福音^_^）"),l("li",null,"vscode用于c++的3个配置文件（需按自己实际情况进行改动）"),l("li",null,"测试程序源文件"),l("li",null,"一个自主编写的makefile文件，用于opencv学习过程中小项目的编译~")],-1)),i[58]||(i[58]=l("p",null,[n("  "),l("a",{href:"https://www.lanzoui.com/b01ho83wb",title:"密码：3pi9",target:"_blank",rel:"noreferrer"},"资源链接"),n("在这里，密码是3pi9。")],-1)),i[59]||(i[59]=l("hr",null,null,-1)),i[60]||(i[60]=l("h2",{id:"参考资料",tabindex:"-1"},[n("参考资料 "),l("a",{class:"header-anchor",href:"#参考资料","aria-label":'Permalink to "参考资料"'},"​")],-1)),i[61]||(i[61]=l("blockquote",null,[l("ol",null,[l("li",null,[l("a",{href:"https://www.cnblogs.com/uestc-mm/p/12758110.html",target:"_blank",rel:"noreferrer"},"Windows10下Opencv4+CMake+MinGW64+VSC安装教程")]),l("li",null,[l("a",{href:"https://docs.opencv.org/4.4.0/d3/d52/tutorial_windows_install.html",target:"_blank",rel:"noreferrer"},"OpenCV Tutorials : Introduction to OpenCV : Installation in Windows")]),l("li",null,[l("a",{href:"https://blog.csdn.net/sz76211822/article/details/82428295",target:"_blank",rel:"noreferrer"},"CMake编译opencv各选项的含义")]),l("li",null,[l("a",{href:"https://blog.csdn.net/tfb760/article/details/104030841",target:"_blank",rel:"noreferrer"},"提升OpenCV编译速度的方法")])])],-1)),i[62]||(i[62]=l("hr",null,null,-1)),i[63]||(i[63]=l("h2",{id:"后记",tabindex:"-1"},[n("后记 "),l("a",{class:"header-anchor",href:"#后记","aria-label":'Permalink to "后记"'},"​")],-1)),i[64]||(i[64]=l("p",null,"  此次编译最大的问题是安装4.4.0库文件时缺少了几个文件，我依稀记得编译4.2.0时好像没出这种幺蛾子，于是用相同的配置把4.2.0也编译了一遍，结果证明不是我的操作与配置问题ヽ(✿ﾟ▽ﾟ)ノ   写作这篇文章时，我力求清晰与详尽，所以可能显得有点啰嗦，还请见谅！",-1)),i[65]||(i[65]=l("hr",null,null,-1))]),"main-header":e(()=>[s(t.$slots,"main-header")]),"main-header-after":e(()=>[s(t.$slots,"main-header-after")]),"main-nav":e(()=>[s(t.$slots,"main-nav")]),"main-content":e(()=>[s(t.$slots,"main-content")]),"main-content-after":e(()=>[s(t.$slots,"main-content-after")]),"main-nav-before":e(()=>[s(t.$slots,"main-nav-before")]),"main-nav-after":e(()=>[s(t.$slots,"main-nav-after")]),comment:e(()=>[s(t.$slots,"comment")]),footer:e(()=>[s(t.$slots,"footer")]),aside:e(()=>[s(t.$slots,"aside")]),"aside-custom":e(()=>[s(t.$slots,"aside-custom")]),default:e(()=>[s(t.$slots,"default")]),_:3},8,["frontmatter"])}}};export{j as default};
